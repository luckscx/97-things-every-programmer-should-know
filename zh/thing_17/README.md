# 只注释代码无法表达的内容

理论与实践之间的差距在实践中比在理论上更大——这一观察当然适用于注释。理论上，注释代码的总体想法听起来是值得的：为读者提供细节，解释正在发生的事情。还有什么比提供帮助更有帮助的呢？然而，在实践中，注释往往成为一种负担。与任何其他形式的写作一样，写好注释需要技巧。大部分技巧在于知道何时不写注释。

当代码格式不正确时，编译器、解释器和其他工具肯定会提出异议。如果代码在功能上存在某种错误，代码审查、静态分析、测试和生产环境中的日常使用会暴露出大多数错误。但注释呢？在《编程风格的元素》中，Kernighan 和 Plauger 指出：“如果注释是错误的，那么它的价值为零（或为负）。”然而，这样的注释常常在代码库中泛滥并存活下来，而代码错误却永远不会如此。它们提供了持续的干扰和错误信息，对程序员的思维产生了微妙但持续的拖累。

那些在技术上没有错误，但对代码没有增加任何价值的注释呢？这样的注释就是噪音。那些重复代码的注释并没有为读者提供额外的信息——在代码中陈述一次，再用自然语言陈述一次，并不会使它更真实或更现实。被注释掉的代码不是可执行代码，因此它对读者或运行时都没有任何有用的效果。它也会很快变得过时。与版本相关的注释和被注释掉的代码试图解决版本控制和历史记录的问题。这些问题已经被版本控制工具（更有效地）解决了。

代码库中充斥着噪音注释和错误注释，这鼓励程序员忽略所有注释，要么跳过它们，要么采取积极措施隐藏它们。程序员是足智多谋的，他们会绕过任何被认为是损害的东西：折叠注释；切换配色方案，使注释和背景颜色相同；编写脚本来过滤掉注释。为了避免程序员聪明才智的误用，并减少忽略任何真正有价值的注释的风险，注释应该被视为代码的一部分。每个注释都应该为读者增加一些价值，否则就应该删除或重写这些浪费的注释。

那么什么才算是价值呢？注释应该表达代码无法表达的内容。解释一段代码应该已经表达的内容的注释，是在邀请改变代码结构或编码约定，使代码自己说话。与其为糟糕的方法或类名进行补偿，不如重命名它们。与其在长函数中注释部分代码，不如提取出较小的函数，其名称能够捕捉到前几部分的意图。尽量通过代码表达尽可能多的内容。你在代码中可以表达的内容与你希望表达的内容之间的任何差距，都可能成为有用注释的候选。注释代码无法表达的内容，而不仅仅是它没有表达的内容。

作者：[Kevlin Henney](http://programmer.97things.oreilly.com/wiki/index.php/Kevlin_Henney)