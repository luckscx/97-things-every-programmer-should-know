# 自动化你的编码标准

你可能也经历过这种情况。在项目开始时，每个人都有很多美好的愿望——可以称之为“新项目的决心”。通常，这些决心中的许多都会被记录在文档中。关于代码的部分最终会写入项目的编码标准中。在项目启动会议上，首席开发人员会逐条讲解文档，最好的情况下，大家都会同意尽力遵守这些标准。然而，一旦项目进入正轨，这些美好的愿望就会一个接一个地被抛弃。当项目最终交付时，代码看起来一团糟，似乎没有人知道为什么会变成这样。

问题出在哪里？很可能在项目启动会议上就已经埋下了隐患。一些项目成员没有认真听，另一些没有理解其中的要点。更糟糕的是，有些人不同意这些标准，并且已经在计划如何反抗这些编码标准。最后，有些人理解了并同意了这些标准，但当项目压力过大时，他们不得不放弃一些东西。格式良好的代码并不会让客户给你加分，尤其是当客户更关注功能时。此外，如果没有自动化，遵循编码标准可能是一项相当枯燥的任务。你可以试着手动为一个混乱的类进行缩进，自己体会一下。

但如果这是一个如此大的问题，为什么我们一开始还要制定编码标准呢？统一代码格式的一个原因是，没有人可以通过以自己私有的方式格式化代码来“拥有”某段代码。我们可能希望防止开发者使用某些反模式，以避免一些常见的错误。总的来说，编码标准应该让项目中的工作更加轻松，并保持开发速度从始至终。因此，每个人都应该同意编码标准——如果一个开发者使用三个空格缩进代码，而另一个使用四个空格，这并没有什么帮助。

有许多工具可以用来生成代码质量报告，并记录和维护编码标准，但这并不是完整的解决方案。应该尽可能地自动化并强制执行这些标准。以下是一些例子：

- 确保代码格式化是构建过程的一部分，这样每个人在编译代码时都会自动运行它。
- 使用静态代码分析工具扫描代码，查找不需要的反模式。如果发现任何问题，中断构建。
- 学会配置这些工具，以便你可以扫描项目中特定的反模式。
- 不仅要测量测试覆盖率，还要自动检查结果。如果测试覆盖率太低，再次中断构建。

尽量为你认为重要的所有事情都这样做。你无法自动化所有你真正关心的事情。对于那些你无法自动标记或修复的事情，可以将它们视为编码标准的补充指南，但要接受你和你的同事可能不会那么严格地遵循它们。

最后，编码标准应该是动态的，而不是静态的。随着项目的发展，项目的需求会发生变化，一开始看起来明智的做法，几个月后可能就不再明智了。

作者：[Filip van Laenen](http://programmer.97things.oreilly.com/wiki/index.php/Filip_van_Laenen)