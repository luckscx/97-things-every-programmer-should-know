#两个错误可以构成一个正确(而且很难改正)

代码从不说谎，但它可能会自相矛盾。有些矛盾导致“这怎么可能行得通？”瞬间。

在一份[interview](http://www.netjeff.com/humor/item.cgi?file=ApolloComputer)，中，阿波罗11号登月舱软件的主要设计者艾伦·克伦普透露，控制引擎的软件存在一个漏洞，本应使着陆器不稳定。然而，另一个错误弥补了第一个错误，在发现或修复任何一个错误之前，该软件曾用于阿波罗11号和12号登月。

考虑一个返回完成状态的函数。想象一下，当它应该返回True时，却返回False。现在假设调用函数忽略了检查返回值。一切正常，直到有一天有人注意到丢失的支票并将其插入。

或者考虑将状态存储为XML文档的应用程序。假设其中一个节点错误地写成了`TimeToLive`，而不是文档所说的`TimeToDie`。一切正常，但写入器代码和读取器代码都包含相同的错误。但修复一个应用程序，或者添加一个阅读同一文档的新应用程序，对称性就会被打破，代码也会被打破。

当代码中的两个缺陷产生一个明显的错误时，修复错误的方法本身就会失效。开发人员得到一份错误报告，找到缺陷，修复它，然后重新测试。然而，报告的故障仍然发生，因为第二个缺陷正在工作。因此，第一个修复被移除，代码被检查，直到找到第二个潜在缺陷，并为此应用修复。但是第一个缺陷已经返回，报告的故障仍然可见，因此回滚第二个修复。这个过程会重复，但现在开发人员已经排除了两个可能的修复程序，并正在寻找第三个永远不会起作用的修复程序。

两个代码缺陷之间的相互作用，看起来像一个明显的错误，不仅使解决问题变得困难，而且将开发人员引向死胡同，结果发现他们很早就尝试了正确的答案。

这不仅仅发生在代码中：这个问题也存在于书面需求文档中。它可以像病毒一样从一个地方传播到另一个地方。代码中的错误补偿书面描述中的错误。

它也可以传播给人们：用户了解到，当应用程序说左就是右时，他们就会相应地调整自己的行为。他们甚至把它传递给新用户：“记住，当应用程序说点击左边的按钮时，它实际上就是右边的按钮。”修复漏洞后，用户突然需要重新培训。

单个错误很容易发现，也很容易修复。更难解决的是多因多变的问题。在一定程度上，这是因为简单的问题很容易解决，人们往往会相对较快地解决这些问题，并将更困难的问题储存起来，留到以后再解决。

对于如何解决由共鸣缺陷引起的故障，没有简单的建议可供参考。需要意识到这种可能性，头脑清醒，愿意考虑所有的可能性。

作者：Allan Kelly](http://programmer.97things.oreilly.com/wiki/index.php/Allan_Kelly)