#便利不是一种享受

关于设计好的API的重要性和挑战，人们已经说了很多。第一次就很难做对，以后更难改变。有点像抚养孩子。大多数有经验的程序员都知道，好的API遵循一致的抽象级别，表现出一致性和对称性，并形成了表达语言的词汇表。唉，意识到指导原则并不会自动转化为适当的行为。吃甜食对你不好。

我不想说三道四，而是想挑出一个我经常遇到的特定API设计“策略”：便利性的论点。它通常以以下一种“洞察力”开始：

-我不希望其他类必须进行两个单独的调用来完成这一件事。
-如果它和这个方法几乎一样，我为什么要做另一个方法呢？我只需添加一个简单的开关。
-看，这很简单：如果第二个字符串参数以“.txt”结尾，方法会自动假设第一个参数是一个文件名，所以我真的不需要两个方法。

虽然用意良好，但这样的参数往往会降低使用API的代码的可读性。像这样的方法调用

```
Parser.process Nodes(Text，False)；
```

在不了解实现或至少查阅文档的情况下，几乎没有意义。这个方法很可能是为了方便实现者而设计的，而不是为了方便调用者--“我不希望调用者必须进行两个单独的调用”，转换为“我不想编写两个不同的方法”。如果方便的目的是为了消除乏味、笨拙或笨拙，那么它从根本上来说并没有什么错。然而，如果我们仔细考虑一下，这些症状的解药是效率、一致性和优雅，而不一定是便利。API被认为应该隐藏底层的复杂性，因此我们可以现实地预期好的API设计需要一些努力。单一的大型方法肯定比一组经过深思熟虑的操作更便于编写，但它会更容易使用吗？

将API比作一种语言可以引导我们在这些情况下做出更好的设计决策。API应该提供一种富于表现力的语言，为上面的下一层提供足够的词汇量来提出和回答有用的问题。这并不意味着它应该为每个可能值得问的问题提供一个确切的方法或动词。多样化的词汇使我们能够表达意义上的微妙之处。例如，我们更喜欢说run而不是walk(真)，即使它可能被视为本质上相同的操作，只是以不同的速度执行。一致和经过深思熟虑的API词汇表有助于在下一层中具有表现力和易于理解的代码。更重要的是，可组合的词汇表允许其他程序员以您可能意想不到的方式使用API-这对API的用户来说确实是非常方便的！下一次当你想把几件事归结到一个API方法中时，记住英语中没有`MakeUpYourRoomBeQuietAndDoYourHomeWork`这个词，尽管对于这样一个频繁请求的操作来说，它似乎真的很方便。

作者：[Gregor Hohpe](http://programmer.97things.oreilly.com/wiki/index.php/Gregor_Hohpe)