#为人们写测试

您正在为部分或全部生产代码编写自动化测试。祝贺你!您是在编写代码之前编写测试的吗？更好！！这样做就会使您成为软件工程实践前沿的早期采用者之一。但你写的测试很好吗？你怎么知道的？一种方法是问“我是为谁写测试的？”如果答案是“对我来说，省去了修复错误的工作”，或者“对编译器来说，这样它们就可以执行了”，那么您很可能没有编写出最好的测试。那么，你应该为谁写测试呢？对于试图理解您的代码的人。

好的测试可以作为他们正在测试的代码的文档。它们描述了代码是如何工作的。对于每个使用场景，测试(S)：

1.描述必须满足的背景、起点或前提条件
2.说明如何调用软件
3.描述需要验证的预期结果或后置条件

不同的使用场景会有略有不同的版本。试图理解您的代码的人应该能够查看一些测试，并通过比较有问题的测试的这三个部分，能够看到是什么导致软件的行为不同。每一项测试都应该清楚地说明这三个部分之间的因果关系。这意味着在测试中不可见的内容与可见的内容同等重要。测试中过多的代码会用不重要的琐事分散读者的注意力。只要有可能，就把这些琐事隐藏在有意义的方法调用后面--提取方法重构是您最好的朋友。并确保为每个测试指定一个描述特定使用场景的有意义的名称，这样测试读者就不必对每个测试进行反向工程来了解各种场景是什么。在它们之间，测试类和类方法的名称至少应该包括起点和如何调用软件。这允许通过快速扫描方法名称来验证测试覆盖率。在测试方法名称中包含预期的结果也很有用，只要这不会导致名称太长而无法查看或阅读。

测试您的测试也是一个好主意。您可以通过将错误插入到生产代码中来验证它们是否检测到您认为它们检测到的错误(当然，您将丢弃您自己的私有副本)。确保他们以有帮助和有意义的方式报告错误。您还应该验证您的测试是否与试图理解您的代码的人清楚地对话。要做到这一点，唯一的方法是让不熟悉您的代码的人阅读您的测试，并告诉您他们学到了什么。仔细听他们说什么。如果他们不清楚某件事，很可能不是因为他们不是很聪明。更有可能的是你说得不是很清楚。(继续，通过阅读他们的测试来颠倒角色！)

作者：Gerard Meszaros](http://programmer.97things.oreilly.com/wiki/index.php/Gerard_Meszaros)
