# 领域特定语言

每当你聆听任何领域的专家讨论时，无论是国际象棋选手、幼儿园教师还是保险代理人，你都会注意到他们的词汇与日常语言大不相同。这就是领域特定语言（DSLs）的一部分：一个特定领域拥有专门的词汇来描述该领域特有的内容。

在软件世界中，DSLs 是关于用特定领域的语言编写的可执行表达式，这些语言具有有限的词汇和语法，且对领域专家来说是可读、可理解且——希望是——可编写的。针对软件开发人员或科学家的 DSLs 已经存在很长时间了。例如，配置文件中出现的 Unix“小语言”以及使用 LISP 宏创建的语言就是一些较早的例子。

DSLs 通常被分类为**内部**或**外部**：

- **内部 DSLs** 是用通用编程语言编写的，其语法被调整得更像自然语言。这对于提供更多语法糖和格式化可能性的语言（例如 Ruby 和 Scala）来说比那些不提供的语言（例如 Java）更容易。大多数内部 DSLs 包装现有的 API、库或业务代码，并提供一个包装器以便更轻松地访问功能。它们只需运行即可直接执行。根据实现和领域的不同，它们用于构建数据结构、定义依赖关系、运行进程或任务、与其他系统通信或验证用户输入。内部 DSL 的语法受宿主语言的限制。有许多模式——例如表达式构建器、方法链和注解——可以帮助你将宿主语言调整为你的 DSL。如果宿主语言不需要重新编译，内部 DSL 可以与领域专家并肩工作，快速开发。

- **外部 DSLs** 是语言的文本或图形表达——尽管文本 DSLs 往往比图形 DSLs 更常见。文本表达式可以通过工具链处理，工具链包括词法分析器、解析器、模型转换器、生成器以及任何其他类型的后处理。外部 DSLs 大多被读入内部模型，这些模型构成了进一步处理的基础。定义语法（例如，在 EBNF 中）是有帮助的。语法为生成工具链的部分（例如编辑器、可视化器、解析器生成器）提供了起点。对于简单的 DSLs，手工制作的解析器可能就足够了——例如使用正则表达式。如果对自定义解析器要求过多，它们可能会变得难以管理，因此有必要查看专门用于处理语言语法和 DSLs 的工具——例如 openArchitectureWare、ANTlr、SableCC、AndroMDA。将外部 DSLs 定义为 XML 方言也很常见，尽管可读性通常是一个问题——特别是对于非技术读者。

你必须始终考虑 DSL 的目标受众。他们是开发人员、经理、业务客户还是最终用户？你必须根据目标受众调整语言的技术水平、可用工具、语法帮助（例如智能感知）、早期验证、可视化和表示。通过隐藏技术细节，DSLs 可以赋予用户能力，使他们能够根据需要调整系统，而无需开发人员的帮助。由于初始语言框架到位后工作的潜在分配，它还可以加快开发速度。语言可以逐步发展。现有表达式和语法也有不同的迁移路径。

作者：[Michael Hunger](http://programmer.97things.oreilly.com/wiki/index.php/Michael_Hunger)