# 保持构建的清洁

你是否曾经看过一份长得像一篇糟糕代码论文的编译器警告列表，然后心里想着：“你知道，我真的应该做点什么……但我现在没时间？”另一方面，你是否曾经看到编译过程中突然出现的一个孤零零的警告，然后立即修复了它？

当我从头开始一个新项目时，没有警告，没有杂乱，没有问题。但随着代码库的增长，如果我不注意，杂乱、冗余、警告和问题就会开始堆积。当有很多噪音时，在数百个我不关心的警告中找到我真正想读的警告就变得困难得多。

为了让警告再次有用，我尝试对构建中的警告采取零容忍政策。即使警告不重要，我也会处理它。如果不重要但仍然相关，我会修复它。如果编译器警告潜在的空指针异常，我会修复原因——即使我“知道”这个问题永远不会在生产环境中出现。如果嵌入式文档（如Javadoc或类似文档）引用了已被删除或重命名的参数，我会清理文档。

如果我真的不关心并且真的不重要，我会询问团队是否可以更改我们的警告策略。例如，我发现记录方法的参数和返回值在许多情况下并没有增加任何价值，因此如果它们缺失，不应该发出警告。或者，升级到新版本的编程语言可能会使以前没问题的代码现在发出警告。例如，当Java 5引入泛型时，所有未指定泛型类型参数的旧代码都会发出警告。这是一种我不想被烦扰的警告（至少现在不想）。拥有一组与现实脱节的警告对任何人都没有好处。

通过确保构建始终是干净的，我就不必每次遇到警告时都决定它是否无关紧要。忽略事情是脑力劳动，我需要尽可能摆脱所有不必要的脑力劳动。保持构建的清洁也使其他人更容易接手我的工作。如果我留下警告，其他人将不得不费力区分哪些是相关的，哪些不是。或者更有可能的是，直接忽略所有警告，包括那些重要的警告。

构建中的警告是有用的。你只需要摆脱噪音，开始注意到它们。不要等待大扫除。当出现你不希望看到的东西时，立即处理它。要么修复警告的源头，抑制这个警告，要么修复你工具的警告策略。保持构建的清洁不仅仅是保持没有编译错误或测试失败：警告也是代码卫生的一个重要且关键的部分。

作者：[Johannes Brodwall](http://programmer.97things.oreilly.com/wiki/index.php/Johannes_Brodwall)