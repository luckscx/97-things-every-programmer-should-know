#当心分享

这是我在公司的第一个项目。我刚刚完成了我的学位，急于证明自己，每天熬夜检查现有的代码。当我完成我的第一个功能时，我格外小心地把我学到的所有东西都放在适当的地方--注释、日志记录，尽可能地将共享代码放入库中，以及工作。我觉得已经准备好的代码审查来了一个粗鲁的觉醒--重用是不受欢迎的！

这怎么可能呢？在大学期间，重用一直被视为高质量软件工程的缩影。我读过的所有文章，教科书，教我的经验丰富的软件专业人士。这一切都错了吗？

事实证明，我错过了一些关键的东西。

上下文。

事实上，系统的两个截然不同的部分以相同的方式执行一些逻辑，这意味着比我想象的要少。在我拿出这些共享代码库之前，这些部分并不相互依赖。每一个都可以独立进化。每一家公司都可以改变其逻辑，以适应系统不断变化的商业环境的需要。这四行类似的代码是偶然的--一种时间上的异常，一种巧合。就是这样，直到我出现。

我创建的共享代码库将每只脚的鞋带都绑在了一起。如果不先与另一个业务域同步，就不能按一个业务域执行步骤。这些独立函数的维护成本过去可以忽略不计，但公共库需要多进行数量级的测试。

虽然我减少了系统中的绝对代码行数，但我增加了依赖项的数量。这些依赖关系的背景是至关重要的--如果它们是本地化的，那么它可能是合理的，并具有一些积极的价值。当这些依赖项没有得到控制时，它们的卷须缠绕在系统的更大关注点上，即使代码本身看起来很好。

这些错误的隐蔽性在于，从本质上讲，它们听起来像是一个好主意。当在正确的环境中应用时，这些技术是有价值的。在错误的背景下，它们增加了成本，而不是价值。当进入现有的代码库时，不知道将在哪里使用各个部分的上下文，这些天来我对共享的内容更加谨慎。

当心这份份额。检查您的上下文。只有在那时，才能继续下去。

作者：[UDI Dahan](http://programmer.97things.oreilly.com/wiki/index.php/Udi_Dahan)