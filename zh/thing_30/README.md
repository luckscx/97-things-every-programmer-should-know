# 不要重复自己

在所有的编程原则中，“不要重复自己”（Don't Repeat Yourself，简称DRY）可能是最基本的原则之一。这一原则由Andy Hunt和Dave Thomas在《程序员修炼之道》中提出，并成为许多其他著名的软件开发最佳实践和设计模式的基础。学会识别重复代码，并理解如何通过适当的实践和正确的抽象来消除重复的开发人员，能够比那些不断在应用程序中引入不必要重复的开发人员编写出更干净的代码。

重复是浪费
---

应用程序中的每一行代码都需要维护，并且是未来潜在的错误来源。重复不必要地膨胀了代码库，导致更多的错误机会，并为系统增加了意外的复杂性。重复给系统带来的膨胀还使得开发人员更难完全理解整个系统，或者确保在一个地方所做的更改不需要在重复逻辑的其他地方也进行更改。DRY原则要求“系统中的每一部分知识都必须有一个单一、明确、权威的表示”。

过程中的重复需要自动化
---

软件开发中的许多过程是重复的，并且很容易自动化。DRY原则不仅适用于应用程序的源代码，也适用于这些上下文。手动测试速度慢、容易出错且难以重复，因此应尽可能使用自动化测试套件。如果手动集成软件，可能会耗费时间且容易出错，因此应尽可能频繁地运行构建过程，理想情况下每次提交代码时都应运行。任何可以自动化的繁琐手动过程都应被自动化和标准化。目标是确保只有一种完成任务的方式，并且这种方式尽可能无痛。

逻辑中的重复需要抽象
---

逻辑中的重复可以采取多种形式。复制粘贴的*if-then*或*switch-case*逻辑是最容易检测和纠正的。许多设计模式的明确目标是减少或消除应用程序中的逻辑重复。如果一个对象通常需要完成几件事才能使用，可以通过抽象工厂或工厂方法来实现。如果一个对象的行为有许多可能的变化，可以使用策略模式来注入这些行为，而不是使用大型的*if-then*结构。事实上，设计模式本身的制定就是为了减少解决常见问题所需的重复工作，并讨论这些解决方案。此外，DRY原则也可以应用于结构，如数据库模式，从而实现规范化。

原则问题
---

其他软件原则也与DRY相关。仅适用于代码功能行为的“一次且仅一次”原则可以被视为DRY的一个子集。开闭原则（Open/Closed Principle）指出“软件实体应该对扩展开放，对修改关闭”，只有在遵循DRY原则时，这一原则才能在实践中发挥作用。同样，著名的单一职责原则（Single Responsibility Principle）要求一个类“只有一个改变的理由”，这也依赖于DRY原则。

当在结构、逻辑、过程和功能方面遵循DRY原则时，它为软件开发人员提供了基本的指导，并有助于创建更简单、更易维护、更高质量的应用程序。虽然在某些情况下，为了满足性能或其他要求（例如数据库中的数据反规范化），重复可能是必要的，但它应该只在直接解决实际问题而不是想象问题时使用。

作者：[Steve Smith](http://programmer.97things.oreilly.com/wiki/index.php/Steve_Smith)